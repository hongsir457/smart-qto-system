# 智能工程量计算系统 - 环境变量配置
# 复制此文件为 .env 并填入实际配置值

# === 基础配置 ===
PROJECT_NAME=智能工程量清单系统
VERSION=1.0.0
API_V1_STR=/api/v1
DEBUG=false

# === 数据库配置 ===
# 本地SQLite（开发环境）
DATABASE_URL=sqlite:///./app/database.db

# Sealos PostgreSQL（生产环境）
# DATABASE_URL=postgresql://用户名:密码@数据库地址:端口/数据库名
POSTGRES_URL=postgresql://postgres:password@dbconn.sealoshzh.site:48982/postgres

# === Redis配置 ===
REDIS_URL=redis://localhost:6379/1
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=1

# === Celery配置 ===
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# === JWT认证配置 ===
SECRET_KEY=your-super-secret-key-change-this-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# === AI服务配置 ===
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_MODEL=gpt-4o-2024-11-20
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.1
ENABLE_GPT_ANALYSIS=true
FALLBACK_TO_TRADITIONAL=true

# === Sealos S3对象存储配置 ===
S3_ENDPOINT=https://objectstorageapi.hzh.sealos.run
S3_ACCESS_KEY=your-sealos-access-key
S3_SECRET_KEY=your-sealos-secret-key
S3_BUCKET=smart-qto-bucket
S3_REGION=us-east-1

# === Sealos云存储配置（新增） ===
SEALOS_STORAGE_URL=https://objectstorageapi.hzh.sealos.run
SEALOS_ACCESS_KEY=your-sealos-access-key
SEALOS_SECRET_KEY=your-sealos-secret-key
SEALOS_BUCKET_NAME=smart-qto-system

# === CORS配置 ===
BACKEND_CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000,http://localhost:8080

# === 文件上传配置 ===
UPLOAD_DIRECTORY=uploads
MAX_UPLOAD_SIZE=104857600  # 100MB
MAX_IMAGE_SIZE=0  # 无限制（支持超高分辨率建筑图纸）
IMAGE_QUALITY=98

# === OCR配置 ===
TESSERACT_PATH=tesseract  # Windows: C:\Program Files\Tesseract-OCR\tesseract.exe
OCR_LANGUAGES=chi_sim+eng
OCR_CONFIDENCE_THRESHOLD=30

# === PaddleOCR配置 ===
PADDLE_OCR_AUTO_RESIZE=true
PADDLE_OCR_TARGET_DPI=300
PADDLE_OCR_MIN_HEIGHT=32
PADDLE_OCR_MAX_SIZE=4096
PADDLE_OCR_SMART_SCALE=true
PADDLE_OCR_CONTRAST_ENHANCE=true
PADDLE_OCR_NOISE_REDUCTION=true

# === Vision分析配置 ===
VISION_SLICE_MAX_RESOLUTION=2048
VISION_SLICE_OVERLAP_RATIO=0.1
VISION_SLICE_MIN_SIZE=512
VISION_SLICE_QUALITY=95

# === 工程量计算默认值 ===
DEFAULT_COLUMN_HEIGHT=3.6
DEFAULT_BEAM_LENGTH=6.0
DEFAULT_SLAB_AREA=100.0

# === WebSocket配置 ===
WEBSOCKET_URL=ws://localhost:8000/ws

# === Celery Worker配置（Windows优化） ===
CELERY_BROKER_POOL_LIMIT=1
CELERY_BROKER_CONNECTION_TIMEOUT=30
CELERY_BROKER_CONNECTION_RETRY=true
CELERY_BROKER_CONNECTION_MAX_RETRIES=3
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TASK_RESULT_EXPIRES=3600
CELERY_WORKER_CONCURRENCY=1
CELERY_WORKER_MAX_TASKS_PER_CHILD=1
CELERY_WORKER_PREFETCH_MULTIPLIER=1
BROKER_CONNECTION_RETRY_ON_STARTUP=true 